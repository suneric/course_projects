% out = [T;Phi;Theta;Yaw_rate]
function out = LQRController(x_err)
A=[0 0 0 1 0 0 0;...
   0 0 0 0 1 0 0;...
   0 0 0 0 0 1 0;...
   0 0 0 0 0 0 0;...
   0 0 0 0 0 0 0;...
   0 0 0 0 0 0 0;...
   0 0 0 0 0 0 0];
B = [0 0 0 0;...
     0 0 0 0;...
     0 0 0 0;...
     1 0 0 0;...
     0 1 0 0;...
     0 0 1 0;...
     0 0 0 1];
% determin Q matrix 7by7
Q=zeros(7); 
Q(1,1) = 1000;
Q(2,2) = 1000;
Q(3,3) = 1000;
Q(4,4) = 1;
Q(5,5) = 1;
Q(6,6) = 1;
Q(7,7) = 1000;
R = zeros(4); 
R(1,1) = 1/1;
R(2,2) = 1/1;
R(3,3) = 1/1;
R(4,4) = 1/1;
[K,~]=lqr(A,B,Q,R);
out = K*x_err;
end